import streamlit as st
import pickle
import numpy as np
import pandas as pd

# ------------------------------------------------------------
# Load trained model and scaler
# ------------------------------------------------------------
@st.cache_resource
def load_model():
    with open('heart_disease_model.pkl', 'rb') as file:
        model, scaler = pickle.load(file)
    return model, scaler

model, scaler = load_model()

# ------------------------------------------------------------
# Streamlit App Configuration
# ------------------------------------------------------------
st.set_page_config(page_title="Heart Disease Prediction", page_icon="ğŸ«€", layout="centered")

st.title("ğŸ©º Heart Disease Prediction System")
st.markdown("""
Welcome!  
This intelligent system predicts the **likelihood of heart disease** using patient data.  
Just fill in the medical details below ğŸ‘‡ and click **Predict Risk**.
""")

st.divider()

# ------------------------------------------------------------
# Input Section
# ------------------------------------------------------------
col1, col2 = st.columns(2)

with col1:
    age = st.number_input("Age (years)", 20, 100, 45)
    gender = st.radio("Gender", ["Male", "Female"])
    chest_pain = st.selectbox("Chest Pain Type", ["Typical Angina (0)", "Atypical Angina (1)", "Non-Anginal (2)", "Asymptomatic (3)"])
    resting_bp = st.number_input("Resting Blood Pressure (mm Hg)", 80, 200, 120)
    cholesterol = st.number_input("Serum Cholesterol (mg/dl)", 100, 600, 220)

with col2:
    fasting_bs = st.radio("Fasting Blood Sugar > 120 mg/dl", ["No (0)", "Yes (1)"])
    resting_ecg = st.selectbox("Resting ECG Results", ["Normal (0)", "ST-T Abnormality (1)", "LV Hypertrophy (2)"])
    max_hr = st.number_input("Maximum Heart Rate", 60, 220, 150)
    exercise_angina = st.radio("Exercise-Induced Angina", ["No (0)", "Yes (1)"])
    st_depression = st.number_input("ST Depression (oldpeak)", 0.0, 6.0, 1.0, step=0.1)
    st_slope = st.selectbox("ST Slope", ["Upsloping (0)", "Flat (1)", "Downsloping (2)"])

col3, col4 = st.columns(2)
with col3:
    major_vessels = st.selectbox("Major Vessels (0â€“3)", [0, 1, 2, 3])
with col4:
    thalassemia = st.selectbox("Thalassemia", ["Normal (1)", "Fixed Defect (2)", "Reversible Defect (3)"])

st.divider()

# ------------------------------------------------------------
# Convert inputs to numeric
# ------------------------------------------------------------
gender = 1 if gender == "Male" else 0
chest_pain = int(chest_pain.split("(")[1].replace(")", ""))
fasting_bs = int(fasting_bs.split("(")[1].replace(")", ""))
resting_ecg = int(resting_ecg.split("(")[1].replace(")", ""))
exercise_angina = int(exercise_angina.split("(")[1].replace(")", ""))
st_slope = int(st_slope.split("(")[1].replace(")", ""))
thalassemia = int(thalassemia.split("(")[1].replace(")", ""))

# Create input array
input_data = np.array([[age, gender, chest_pain, resting_bp, cholesterol, fasting_bs,
                        resting_ecg, max_hr, exercise_angina, st_depression,
                        st_slope, major_vessels, thalassemia]])

# ------------------------------------------------------------
# Prediction Logic
# ------------------------------------------------------------
if st.button("ğŸ” Predict Risk"):
    with st.spinner("Analyzing patient data... ğŸ©¸"):
        scaled_input = scaler.transform(input_data)
        prediction = model.predict(scaled_input)[0]

    st.divider()

    if prediction == 1:
        st.error("âš ï¸ **High risk of Heart Disease detected!**")
        st.markdown("""
        ### ğŸ”´ Recommendations:
        - Consult a cardiologist soon.
        - Maintain a low-fat diet.
        - Exercise regularly and monitor BP & cholesterol.
        """)
    else:
        st.success("âœ… **No signs of Heart Disease detected.**")
        st.markdown("""
        ### ğŸŸ¢ Health Tips:
        - Maintain a balanced diet.
        - Exercise daily and get regular check-ups.
        """)

st.divider()
st.caption("Developed by **Vikas Sharma** | Â© 2025 | Machine Learning Project")
streamlit
pandas
numpy
scikit-learn
